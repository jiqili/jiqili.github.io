---
title: XSS的类型和防御
tags: [Security]
---
# 前言
XSS分为反射型，存储型和DOM型。列举几个实例：
- 存储型
发了包含恶意脚本的评论，别人看到你的评论时，恶意脚本就执行了。
- 反射型
恶意邮件中误导用户点击恶意的url,url中有search参数，在search参数中输入恶意脚本，服务端实现了模糊查询，查询到近似的内容后，直接把请求里的查询进行字符串拼接返回了。或者返回的html因为还要包括用户的查询内容，所以也把查询内容拼接到html里了。这样就导致恶意脚本被执行了。
- DOM型
和反射型XSS类似，但是前端js代码中有获取当前url的search参数然后直接拼接到html里导致恶意脚本执行了。

# 防御
- 服务端进行过滤
- 设置CSP,只允许可信源的脚本执行
- 前端框架进行转义

后两点可以解决本文列举的三个案例。
